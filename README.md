# eagent

## 需求说明：
1. 每个 item 是一个定时调度任务，由多个自定义的和保留的字段构成，每个字段的值被认为是字符串
保留至少3个字段：
* cron： cron表达式，表示何时调度/或者每隔多少秒执行
* condition: 表示调度的先验条件，当到达调度时机，检查是否满足条件，满足才执行
* action: 要执行的命令
* state: 要保存的状态，供多次调度间共享，使用场景如异常检测，连续多次CPU使用率超过90%才触发动作 ？？？

2. 每个文件中可以写多个 item, 作为名为 items 的列表项，

3. 为了方便变量共享，每个文件可以写 global， global 中定义的变量为每个 item 共享，每个item 中如果重写了某个变量，以 item 中的为准

4. 变量可以相互在可见的作用域内，变量可以相互引用，语法为 ${var}

5. 存在全局的变量空间，命名规约为 env.varname，在程序启动时以 -D env.varname=value 的方式传入；并且至少存在这样几个保留的全局变量：
* env.homedir 表示程序的home路径
* env.schedule_date 表示程序的调度日期，格式：2019-02-03
* env.schedule_time 表示程序的调度时间，格式：20:30:00
* env.schedule_timestamp 表示调度时的unix时间戳，单位秒
由于每个任务的调度时间可能都不一样，所以后面三个在每个任务中获取的值是不一样的
全局变量是只读的

6. 状态处理
state 字段相当于注册了要保存的状态字段，
state: cpu:3
cpu
cpu-1:-3==1 

